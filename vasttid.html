
<!DOCTYPE html>
<html>
  <head>
    <title>VastTid configuration</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, inital-scale=1">

  </head>
  <body>

    <h1>VastTid configuration</h1>

    <label> Favorite stop 1 </label>
    <input name="favoritestop_1" id="favoritestop_1">
    <br>
    <label> Direction (1st) for favorite 1 (optional) </label>
    <input name="favoritedirection_1_1" id="favoritedirection_1_1">
    <br>
    <label> Direction (2nd) for favorite 1 (optional) </label>
    <input name="favoritedirection_1_2" id="favoritedirection_1_2">
    <br>
    <label> Direction (3rd) for favorite 1 (optional) </label>
    <input name="favoritedirection_1_3" id="favoritedirection_1_3">
    <br>


    <br>
    <label> Favorite stop 2 </label>
    <input name="favoritestop_2" id="favoritestop_2">
    <br>
    <label> Direction (1st) for favorite 2 (optional) </label>
    <input name="favoritedirection_2_1" id="favoritedirection_2_1">
    <br>
    <label> Direction (2nd) for favorite 2 (optional) </label>
    <input name="favoritedirection_2_2" id="favoritedirection_2_2">
    <br>
    <label> Direction (3rd) for favorite 2 (optional) </label>
    <input name="favoritedirection_2_3" id="favoritedirection_2_3">
    <br>

    <button type="submit" id="b-cancel">Cancel</button>
    <button type="submit" id="b-submit" class="btn btn-default" >Save</button>

    <script>
      function saveOptions() {
        var options = {
          'favoritestop_1' : $("#favoritestop_1").val(),
          'favoritestop_2' : $("#favoritestop_2").val(),
          'favoritedirection_1_1' : $("#favoritedirection_1_1").val(),
          'favoritedirection_1_2' : $("#favoritedirection_1_2").val(),
          'favoritedirection_1_3' : $("#favoritedirection_1_3").val(),
          'favoritedirection_2_1' : $("#favoritedirection_2_1").val(),
          'favoritedirection_2_2' : $("#favoritedirection_2_2").val(),
          'favoritedirection_2_3' : $("#favoritedirection_2_3").val(),
        }
        return options;
      }

      // Get query variables
      function getQueryParam(variable, defaultValue) {
      // Find all URL parameters
      var query = location.search.substring(1);
      var vars = query.split('&');
      for (var i = 0; i < vars.length; i++) {
        var pair = vars[i].split('=');

        // If the query variable parameter is found, decode it to use and return it for use
        if (pair[0] === variable) {
          return decodeURIComponent(pair[1]);
        }
      }
      return defaultValue || false;
      }

      var submitButton = document.getElementById('b-submit');
      submitButton.addEventListener('click', function() {
        var return_to = getQueryParam('return_to', 'pebblejs://close#');
        var location = return_to + encodeURIComponent(JSON.stringify(saveOptions()));
        document.location = location;
      });

      var cancelButton = document.getElementById('b-cancel');
      cancelButton.addEventListener('click', function() {
        var return_to = getQueryParam('return_to', 'pebblejs://close');
        var location = return_to;
        document.location = location;
      });
    </script>

    <script src="http://code.jquery.com/jquery.js"></script>
  </body>
</html>
